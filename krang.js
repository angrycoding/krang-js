(function(t){var e=t,n=function(){function t(t,e,n){return e?s[e]:String.fromCharCode(parseInt(n,16))}function e(e,n){var r,i=e.match(o),a=i[0],s=!1;"{"===a?r={}:"["===a?r=[]:(r=[],s=!0);for(var l,h=[r],d=1-s,g=i.length;g>d;++d){a=i[d];var v;switch(a.charCodeAt(0)){default:v=h[0],v[l||v.length]=+a,l=void 0;break;case 34:if(a=a.substring(1,a.length-1),-1!==a.indexOf(f)&&(a=a.replace(u,t)),v=h[0],!l){if(!(v instanceof Array)){l=a||c;break}l=v.length}v[l]=a,l=void 0;break;case 91:v=h[0],h.unshift(v[l||v.length]=[]),l=void 0;break;case 93:h.shift();break;case 102:v=h[0],v[l||v.length]=!1,l=void 0;break;case 110:v=h[0],v[l||v.length]=null,l=void 0;break;case 116:v=h[0],v[l||v.length]=!0,l=void 0;break;case 123:v=h[0],h.unshift(v[l||v.length]={}),l=void 0;break;case 125:h.shift()}}if(s){if(1!==h.length)throw Error();r=r[0]}else if(h.length)throw Error();if(n){var y=function(t,e){var r=t[e];if(r&&"object"==typeof r){var i=null;for(var a in r)if(p.call(r,a)&&r!==t){var o=y(r,a);void 0!==o?r[a]=o:(i||(i=[]),i.push(a))}if(i)for(var u=i.length;--u>=0;)delete r[i[u]]}return n.call(t,e,r)};r=y({"":r},"")}return r}function n(t){var e=typeof t;if("object"!=e||null===t)return"string"==e&&(t='"'+t+'"'),t+"";var r,i,a=[],o=t&&t.constructor==Array;for(r in t)i=t[r],e=typeof i,"string"==e?i='"'+i+'"':"object"==e&&null!==i&&(i=n(i)),a.push((o?"":'"'+r+'":')+(i+""));return(o?"[":"{")+(a+"")+(o?"]":"}")}var r="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",i='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',a='(?:"'+i+'*")',o=RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+r+"|"+a+")","g"),u=RegExp("\\\\(?:([^u])|u(.{4}))","g"),s={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},c=new String(""),f="\\",p=Object.hasOwnProperty;return{parse:e,stringify:n}}(),r=function(t,e){function n(t,e){var n=t.charAt(e),r=F.indexOf(n);if(-1===r)throw"illegal `"+n+"` character";return r}function r(t){var t=t.split("/"),e=""===t[0],n=[],r="";for(e&&t.shift();t.length;)r=t.shift(),".."===r?n.pop():"."!==r&&n.push(r);return e&&n.unshift(""),("."===r||".."===r)&&n.push(""),n.join("/")}function i(t){return void 0===t}function a(t){return"boolean"==typeof t}function o(t){return"string"==typeof t}function u(t){return t instanceof Array}function s(t){return t instanceof Function}function c(t){return t instanceof Object&&!(t instanceof Function)&&!(t instanceof Array)}function f(t){var e,r,i=[],a=0,t=t+"",o=t.length;if(!o)return t;if(o%4)throw"incorrect padding";for("="===t.charAt(o-1)&&(a=1,"="===t.charAt(o-2)&&(a=2),o-=4),e=0;o>e;e+=4)r=n(t,e)<<18,r|=n(t,e+1)<<12,r|=n(t,e+2)<<6,r|=n(t,e+3),i.push(String.fromCharCode(r>>16,255&r>>8,255&r));return a&&(r=n(t,e)<<18,r|=n(t,e+1)<<12,i.push(String.fromCharCode(r>>16)),1===a&&(r|=n(t,e+2)<<6,i.push(String.fromCharCode(255&r>>8)))),i.join("")}function p(t,e){return null!==t&&void 0!==t&&"string"==typeof e&&Object.prototype.hasOwnProperty.call(t,e)}function l(t){if(c(t)){var e={};for(var n in t)e[n]=l(t[n]);return e}if(u(t)){for(var e=Array(t.length),r=0;t.length>r;r++)e[r]=l(t[r]);return e}return t}function h(){var t,e,n,r,a={},o=arguments.length;for(t=0;o>t;t++)if(c(r=arguments[t]))for(e in r)p(r,e)&&(i(n=r[e])?p(a,e)&&delete a[e]:a[e]=p(a,e)&&c(a[e])&&c(n)?h(a[e],n):c(n)?h(n):n);return a}function d(t,e,n,r){s(n)||(n=null),i(t)?t=[]:u(t)||(t=[t]);var a=t.length,o=Array(a);if(s(e)&&a){var c,f=a;for(c=0;a>c;c++)e.call(r,t[c],function(t){return function(e){o[t]=e,--f||n&&n.call(r,o)}}(c),c)}else n&&n.call(r,o)}function g(n){return i(t.JSON)?e.parse(n):t.JSON.parse(n)}function v(n){return i(t.JSON)?e.stringify(n):t.JSON.stringify(n)}function y(t){return o(t)?t.replace(/^\s+/,""):""}function m(t){return o(t)?t.replace(/\s+$/,""):""}function w(t,e,n){if(!o(t))return!1;if(!o(e))return!1;var r=t.substr(0,e.length);return n&&(e=e.toLowerCase(),r=r.toLowerCase()),e===r}function b(t){var e=t.match(j),n=(e[1]||"").toLowerCase(),r=(e[2]||"").toLowerCase(),i=e[3]||"",a=i.split("/").pop(),o=a.match(E);return o=o&&o[1]||"","http"===n&&":80"===r.slice(-3)?r=r.slice(0,-3):"https"===n&&":443"===r.slice(-4)&&(r=r.slice(0,-4)),{scheme:n,authority:r,path:i,fileName:a,fileType:o,query:e[4]||"",fragment:e[5]||""}}function x(t){var e,n={type:"text/plain",data:"",encoding:"",params:{charset:"US-ASCII"}};if(o(t)&&w(t,"data:",!0))for(e=t.substr(5).split(","),t=e.shift().split(";"),n.data=e.join(","),n.type=t.shift();t.length;)e=t.shift().split("="),o(e[1])?n.params[e[0]]=e[1]:n.encoding=e[0];return n}function T(t){var e={};return o(t)?(t.replace(RegExp("([^?=&]+)(=([^&]*))?","g"),function(t,n,r,i){e[n]=i}),e):{}}function O(t){return(t.scheme?t.scheme+"://":"")+(t.authority?t.authority:"")+(t.path?t.path:"")+(t.query?"?"+t.query:"")+(t.fragment?"#"+t.fragment:"")}function A(t){var e,n=[];if(!c(t))return"";for(e in t)t.hasOwnProperty(e)&&n.push(e+"="+t[e]);return n.join("&")}function k(t,e){var n=t,i=e;o(n)&&(n=b(n)),o(i)&&(i=b(i));var a="",u="";return n.scheme?(a+=n.scheme+":",(u=n.authority)&&(a+="//"+u),(u=r(n.path))&&(a+=u),(u=n.query)&&(a+="?"+u)):((u=i.scheme)&&(a+=u+":"),(u=n.authority)?(a+="//"+u,(u=r(n.path||""))&&(a+=u),(u=n.query)&&(a+="?"+u)):((u=i.authority)&&(a+="//"+u),(u=n.path)?((u=r("/"===u.charAt(0)?u:(i.authority&&!i.path?"/":(i.path.match(S)||[""])[0])+u))&&(a+=u),(u=n.query)&&(a+="?"+u)):((u=i.path)&&(a+=u),((u=n.query)||(u=i.query))&&(a+="?"+u)))),(u=n.fragment)&&(a+="#"+u),a}var S=/^(.*)\//,E=/.+\.([^\.]+)$/,F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j=/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/;return{isUndefined:i,isBoolean:a,isString:o,isArray:u,isFunction:s,isMap:c,mapAsync:d,base64decode:f,hasOwnProperty:p,json:{parse:g,stringify:v},object:{clone:l,merge:h},string:{trimLeft:y,trimRight:m,startsWith:w},uri:{parse:b,parseQuery:T,format:O,formatQuery:A,resolve:k,parseData:x}}}(e,n),i={uri:"MY_BASE_URI"},a=function(t){var e={};if("object"==typeof t.window&&"object"==typeof t.window.navigator&&"string"==typeof t.window.navigator.userAgent){var n,r=t.window.navigator.userAgent;(n=r.match(/AppleWebKit\/([\d.]+)/))?(e.webkit={version:parseFloat(n[1])},(n=r.match(/Chrome\/([\d.]+)/))?e.chrome={version:parseFloat(n[1])}:(n=r.match(/Version\/([\d.]+)/))&&(e.safari={version:parseFloat(n[1])})):(n=r.match(/Gecko\/([\d.]+)/))?(e.gecko={version:parseFloat(n[1])},(n=r.match(/Firefox\/([\d.]+)/))&&(e.firefox={version:parseFloat(n[1])})):(n=r.match(/MSIE\s([\d.]+)/))?e.ie={version:parseFloat(n[1])}:(n=r.match(/Opera\/([\d.]+)/))&&(e.opera={version:parseFloat(n[1])},(n=r.match(/Version\/([\d.]+)/))&&(e.opera={version:parseFloat(n[1])})),e={browser:e}}else if("object"==typeof t.process&&"string"==typeof t.process.version){var n=t.process.version;n=n.match(/\d+\.\d+[\.\d+]*/),e.nodejs={version:parseFloat(n[0])}}else if(t.Packages instanceof Object){var n=Packages.org.mozilla.javascript.Context;n=n.getCurrentContext().getImplementationVersion(),n=(n+"").match(/\d+\.\d+[\.\d+]*/),e.rhino={version:parseFloat(n[0])}}return e}(e),o=function(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);t.unshift("[ KRANG ]"),console.log(t.join(" "))}function i(t,e){return{file:t,toString:function(){return e}}}function a(t,e){return i(t,'dependency must be a string, array or map, but "'+e+'" found ('+t+")")}function o(t,e,n){return i(t,'error decoding "'+e+'" with message "'+n+'" ('+t+")")}function u(t,e){return i(t,'failed to resolve dependency alias "@'+e+'" for "'+t+'"')}function s(t,e,n){return i(t,'failed to load dependency "'+e+'" for "'+t+'" '+'with message "'+n+'"')}function c(t){return i(t,'failed to load dependency "'+t+'" '+'with message "missing required define call"')}function f(t){return i(t,'failed to load dependency "'+t+'" '+'with message "duplicate define call"')}function p(t,e,n){if(g.hasOwnProperty(t))throw new f(t);g[t]=!0;var r,e=Array.prototype.slice.call(e),i=e.shift();e.length&&(r=i,i=e.shift()),n(r,i)}function l(){return n.nodejs?module.parent.filename:n.browser?t.location.href:void 0}function h(){var e;if(e=arguments.callee.caller)do if(e.hasOwnProperty("currentScript"))return{src:e.currentScript};while(e=e.caller);if(n.browser){if(t.document&&t.document.currentScript)return t.document.currentScript;try{throw Error()}catch(r){if(r.stack){e=r.stack,-1===e.indexOf("@")?(e=e.split("\n").pop(),e=e.split(" ").pop()):e=e.split("@").pop(),e=e.split(/(\:\d+)+\s*$/).shift();for(var i=0;d.length>i;i++)if(d[i].src===e)return d[i]}else for(var i=0;d.length>i;i++)if("interactive"===d[i].readyState)return d[i]}}}var d=[],g={};return n.browser&&t.document&&t.document.getElementsByTagName&&(d=document.getElementsByTagName("script")),{T_VALUE:1,T_CONFIG:2,T_GLOBAL:3,T_MODULE:4,T_RESOURCE:5,VERSION:.4,message:r,define:p,getBaseURI:l,getCurrentScript:h,TypeException:a,AliasException:u,DataURIException:o,LoadException:s,MissingDefinition:c}}(e,i,a),u=function(t){function e(e){return t.isString(e)||(e=""),s.hasOwnProperty(e)?s[e]:s[e]={uses:{},views:{}}}function n(n,r){var i=e(n);return t.isString(r)||(r=""),i.views.hasOwnProperty(r)?i.views[r]:i.views[r]={status:a,waiting:[]}}function r(t,e){if(t===e)return!0;for(var n in s[t].uses)if(r(n,e))return!0}function i(t,e){t.data=e,t.status=u;for(var n=t.waiting;n.length;)n.shift()(e)}var a=0,o=1,u=2,s={};return function(){var a,s,c,f,p,l=Array.prototype.slice.call(arguments);t.isString(l[0])&&(a=l.shift()),t.isString(l[0])&&(s=l.shift()),t.isFunction(l[0])&&(f=l.shift()),t.isFunction(l[0])&&(c=l.shift()),t.isString(l[0])&&(p=l.shift());var h=n(a,s);if(h.status===u)return f?f(h.data):h.data;if(t.isString(p)&&(e(p).uses[a]=!0,r(a,p)))throw p+" refers back to "+a;f&&h.waiting.push(f),h.status!==o&&(h.status=o,c?c(a,function(t){i(h,t)},p):i(h))}}(r),s=function(t,e){function n(){o||(o=!0,i=require("url"),a={file:require("fs"),http:require("http"),https:require("https")})}function r(r,o,u){n();var s=t.uri.parse(r),c=s.scheme||"file";"http"===c||"https"===c?a[c].request({method:"GET",path:[s.path,s.query].join("?"),hostname:s.authority},function(t){if(t.statusCode>300&&400>t.statusCode&&t.headers.location){var n=i.parse(t.headers.location);return n.port||(n.port=s.port),n.host||(n.host=s.host),n.hostname||(n.hostname=s.hostname),n.protocol||(n.protocol=s.protocol),doHTTPRequest(n,o,u)}var a="";t.on("end",function(){try{var t=!1,n=Function("define, require, module",a);if(n.currentScript=r,n(function(){t=!0,e.define(r,arguments,o)},require,module),!t)throw new e.MissingDefinition(r)}catch(i){u(i)}}).on("data",function(t){a+=t})}).on("error",u).end():"file"===c?a[c].readFile(s.path,function(t,n){if(t)return u(t);try{Function("define, require, module",""+n)(function(){e.define(r,arguments,o)},require,module)}catch(i){u(i)}}):u("unsupported scheme:"+c)}var i,a,o=!1;return r}(r,o),c=function(t,e,n){function r(){for(var t=!1,e=0;s.length>e;e++)try{t=s[e]();break}catch(n){}return t}function i(t,n){var t=e.uri.parse(t),n=e.uri.parse(n);return t.scheme==n.scheme&&t.authority===n.authority}function a(t,e){var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("async","async"),r.setAttribute("src",t),u[t]=e,r.onload=function(){if(!u[this.src].called)throw new n.MissingDefinition(this.src)},document.getElementsByTagName("head")[0].appendChild(r)}function o(t,e,i){var a=r();if(!a)return i("could not instantiate XMLHttpRequest");try{a.open("GET",t,!0),a.onreadystatechange=function(){if(4===a.readyState){var r=a.status;if(200!==r)return i("not found");try{var o=!1,u=Function("define",a.responseText);if(u.currentScript=t,u(function(){o=!0,n.define(t,arguments,e)}),!o)throw new n.MissingDefinition(t)}catch(s){i(s)}}},a.send(null)}catch(o){i(o)}}var u={};t.define=function(){var t=n.getCurrentScript();if(!t)return!1;var e=t.src;if(!u.hasOwnProperty(e))return!1;var r=u[e];return r.called=!0,n.define(e,arguments,r),!0};var s=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return function(t,e,n){i(window.location.href,t)?o(t,e,n):a(t,e,n)}}(e,r,o),f=function(t,e,n,r){var i=null;return e.nodejs?i=n:e.browser&&(i=r),function(e,n,r,a){if(t.isString(n)){if(t.isFunction(a)||(a=function(){}),t.isFunction(r)||(r=function(){}),!e.cache){n=t.uri.parse(n);var o=t.uri.parseQuery(n.query);o["krang.nocache"]=(new Date).getTime(),n.query=t.uri.formatQuery(o),n=t.uri.format(n)}i(n,r,a)}}}(r,a,s,c),p=function(){var t=-1,e=0,n=1,r=2,i=function(){function i(){if(y!==c)if(h=T[0].exec(s)){for(d=h.length,g=1;d>g;g++)if(f=h[g]){switch(v=h.index,(p=v-y)&&(w=m.push({type:e,pos:y,value:s.substr(y,p)}),y+=p),p=f.length,y=v+p,l=T[1][g-1],l[0]){case r:w=m.push({type:l[1],pos:v,value:f});break;default:i()}break}}else(p=c-y)&&(w=m.push({type:e,pos:y,value:s.substr(y,p)}),y+=p);else w=m.push({type:t,value:"EOF",pos:c})}function a(){w||i(),w--,u=m.shift()}function o(t,e){return"object"!=typeof t&&(t=[t]),b++,x.push("("+t.join("|")+")"),T[1].push([e,b]),b}var u,s,c,f,p,l,h,d,g,v,y,m,w,b=0,x=[],T=[[],[]];this.addToken=function(t){return o(t,r)},this.addIgnore=function(t){return o(t,n)},this.tokenize=function(t){y=0,m=[],w=0,u=null,s=t,c=t.length,T[0]=x.join("|"),T[0]=RegExp(T[0],"g"),a()},this.getFragment=function(){return u.value?u.value:s.substr(u.pos,u.len)},this.test=function(t){return u.type===t},this.next=function(t){if(void 0===t||this.test(t)){var e=u;return a(),e}}};return i.T_EOF=t,i.T_FRAGMENT=e,i}(),l=function(t,e){function n(){v||(v=new t,w=v.addToken("or\\b"),b=v.addToken("and\\b"),x=v.addToken("not\\b"),T=v.addToken("\\."),O=v.addToken("\\("),A=v.addToken("\\)"),k=v.addToken("="),S=v.addToken("<>"),E=v.addToken("<="),F=v.addToken(">="),j=v.addToken("<"),C=v.addToken(">"),R=v.addToken(["[0-9]*\\.[0-9]+","[0-9]+"]),U=v.addToken(["'(?:[^'\\\\]|\\\\.)*'",'"(?:[^"\\\\]|\\\\.)*"']),_=v.addToken("[a-zA-Z_$][a-zA-Z0-9_$]*"),v.addIgnore("[	\n\r ]+"))}function r(t,e){var t=t||"EOF",e=e||v.getFragment(),n='parse error: "'+t+'" expected, but "'+e+'" found '+"("+y+")";return{fileName:y,expected:t,found:e,toString:function(){return n}}}function i(){if(v.test(R)){var t=v.next();return t=parseFloat(t.value,10),[L,t]}if(v.test(U)){var t=v.next();return[I,t.value.slice(1,-1)]}if(v.test(_)){var t=v.next();return[q,[t.value]]}if(v.next(O)){if(v.next(A))throw new r("expression","()");try{var t=f()}finally{if(!v.next(A))throw new r(")")}return t}throw new r("expression")}function a(){var t=i();if(!v.test(T))return t;if(t[0]!==q)throw new r;for(;v.next(T);){if(!v.test(_))throw new r("identifier");t[1].push(v.next().value)}return t}function o(){return v.next(x)&&[M,o()]||a()}function u(){var t=o();return v.next(E)&&[D,t,o()]||v.next(j)&&[P,t,o()]||v.next(F)&&[G,t,o()]||v.next(C)&&[N,t,o()]||t}function s(){for(var t=u();v.next(k)&&(t=[B,t,u()])||v.next(S)&&(t=[V,t,u()]););return t}function c(){for(var t=s();v.next(b)&&(t=[X,t,s()]););return t}function f(){for(var t=c();v.next(w)&&(t=[H,t,c()]););return t}function p(){var e=f();if(!v.test(t.T_EOF))throw new r("EOF");return e}function l(t){var n=t[0];switch(n){case L:case I:return t[1];case H:case M:case X:var r=h(l(t[1]));if(n===M)return!r;if(r&&n===H)return!0;var i=h(l(t[2]));if(n===X)return r&&i;if(n===H)return r||i;case B:case V:case P:case N:case D:case G:var r=l(t[1]),i=l(t[2]);if(n===B)return r===i;if(n===V)return r!==i;if(n===P)return i>r;if(n===N)return r>i;if(n===D)return i>=r;if(n===G)return r>=i;case q:var a,o,u=m,s=t[1];for(a=0;s.length>a;a++){if(o=s[a],!e.hasOwnProperty(u,o)){u=void 0;break}u=u[o]}return u}}function h(t){return void 0===t?!1:null===t?!1:t===!0?!0:t===!1?!1:"number"==typeof t?0!==t:"string"==typeof t?0!==t.length:t instanceof Array?0!==t.length:t instanceof Function?!0:t instanceof Object?!0:void 0}function d(t,e){return n(),y=e,v.tokenize(t),p()}function g(t){return function(e,n){m=t;var r=d(e,n),i=l(r);return h(i)}}var v,y,m,w,b,x,T,O,A,k,S,E,F,j,C,R,U,_,L=1,I=2,q=3,M=4,P=5,N=6,D=7,G=8,B=9,V=10,X=11,H=12;return g}(p,r),h=function(t,e,n,r,i,a){function o(n,r){var i=t.uri.parseData(r),a=i.data;try{return a="base64"===i.encoding?t.base64decode(a):decodeURIComponent(a),"application/json"===i.type&&(a=t.json.parse(a)),a}catch(o){throw new e.DataURIException(n,r,o.message||o)}}function u(e,n){var e=t.uri.parse(e);return e.fragment="",e.path=e.path.replace(/\/+/g,"/"),e.fileName&&!e.fileType&&(e.path+=".js"),t.uri.resolve(e,n)}function s(e){t.isString(e)||(e="");var n=(new Date).getTime();return e+n.toString(36)+(1+Math.floor(32767*Math.random())).toString(36)+(1+Math.floor(32767*Math.random())).toString(36)}function c(){return s("__KRANG"+ ++h+"__")+"__"}function f(e){return t.isUndefined(e)||(e+=""),e?l.hasOwnProperty(e)?l[e]:l[e]=c():c()}var p=new a(n),l={},h=0;return function(n,a,s){function c(t,r,a){n.debug&&e.message("loading",t),i(n,t,function(e,n){v(t,e,function(t){r([t,n])})},function(n){throw new e.LoadException(a,t,n)})}function l(r,i,a,o){if(t.hasOwnProperty(n,"packages")&&t.hasOwnProperty(n.packages,i))return i=n.packages[i],a&&(i+="!"+a),h(r,i,o);throw new e.AliasException(r,i)}function h(i,a,s){var a=t.string.trimLeft(a);if(t.string.startsWith(a,"data:",!0))return s({type:e.T_VALUE,base:i,data:o(i,a)});a=t.string.trimRight(a);var p=a.replace(/\s*!+\s*/g,"!");if(p=p.split("!"),"module"===p[0]&&p.unshift(""),!(a=p.shift())){if("global"===p[0])return s({id:f(["global",p]),type:e.T_GLOBAL,base:i,data:p});if("module"===p[0])return s({id:f(["module",i,p]),type:e.T_MODULE,base:i,data:p});if("config"===p[0])return s({id:f(["config",p,JSON.stringify(n.config)]),type:e.T_CONFIG,base:i,data:p});throw"Unknown system plugin call: "+p[0]}return p=p.join("!"),"@"===a[0]?(a=a.substr(1),l(i,a,p,s)):(a=u(a,i),r(a,function(){s({id:f(["resource",a,p]),type:e.T_RESOURCE,base:i,uri:a,data:p})},c,i),void 0)}function d(t,e,n){for(var r in e)if(p(r,t))return g(t,e[r],n);n()}function g(n,r,i){if(t.isString(r))h(n,r,i);else{if(!t.isMap(r))throw new e.TypeException(n,r);d(n,r,i)}}function v(e,n,r){t.mapAsync(n,function(t,n){g(e,t,n)},r)}v(n.baseURI,a,s)}}(r,o,a,u,f,l),d=function(t,e,n,r,i){function a(r,a,o,u,s){function c(a,o){n.mapAsync(a,function(a,o){var f=a.base;if(a.type===e.T_RESOURCE){var p=a.uri,l=a.data;i(p,"evaluated",function(t){l&&n.hasOwnProperty(t,"krang")&&n.isFunction(t.krang)?t.krang(f,l,o,u,s):o(t)},function(t,a){r.debug&&e.message("evaluating",t);var o=i(t),u=o[1],s=o[0];return n.isFunction(u)?(c(s,function(t){a(u.apply(this,t))}),void 0):a(u)})}else a.type===e.T_GLOBAL?o(t):a.type===e.T_MODULE?o({uri:f}):a.type===e.T_CONFIG?o(r.config):a.type===e.T_VALUE&&o(a.data)},o)}c(a,o)}return a}(e,o,r,h,u),g=function(t,e,n,r){function i(t,n){return e.isFunction(t)?"("+(t+"")+")("+n+")":e.isUndefined(t)?"undefined":JSON.stringify(t)}function a(a,o,u,s){function c(o,u,l){e.mapAsync(o,function(e,o){var u=e.id;if(p.hasOwnProperty(u))return o(u);p[u]=!0;var h=e.type;if(h===t.T_RESOURCE){var d=e.data,g=n(e.uri),v=g[1],y=g[0];return d?r(a,e,function(t){for(var t=t[0],e=0;t.length>e;e++)p.hasOwnProperty(t[e].exportAs)||(t[e].main&&(t[e].main=l,t[e].exportAs=u),f.push(t[e]));o(u)},s,!0):c(y,function(t){f.push({type:"value",main:l,exportAs:u,data:i(v,t)}),o(u)})}h===t.T_GLOBAL?f.push({type:"global",main:l,exportAs:u,data:e.data}):h===t.T_MODULE?f.push({type:"module",main:l,exportAs:u,data:e.data}):h===t.T_CONFIG?f.push({type:"value",main:l,exportAs:u,data:i(a.config)}):h===t.T_VALUE&&f.push({type:"value",main:l,exportAs:u,data:i(e.data)}),o(u)},u)}var f=[],p={};c(o,function(){u(f)},!0)}return a}(o,r,u,d),v=function(t,e,n,r,i,a){function o(e){var n=[],r=null,i=Array.prototype.slice.call(e);return t.isString(i[0])?n=[i.shift()]:t.isArray(i[0])&&(n=i.shift()),t.isFunction(i[0])&&(r=i.shift()),[n,r]}function u(e,n){var r=e.baseURI,n=t.object.clone(n);if(t.hasOwnProperty(n,"baseURI")&&(t.isString(n.baseURI)?r=n.baseURI=t.uri.resolve(n.baseURI,r):delete n.baseURI),t.hasOwnProperty(n,"cache")&&!t.isBoolean(n.cache)&&(n.cache=n.cache+""),t.hasOwnProperty(n,"packages")){var i=n.packages;if(t.isMap(i)){var a,o;for(a in i)o=i[a],o=t.string.trimLeft(o),t.isString(o)?i[a]=t.uri.resolve(o,r):delete i[a]}else t.isUndefined(i)||delete n.packages}return t.object.merge(e,n)}function s(n){function c(t){return s(u(n,t))}return n.debug&&e.message("applying configuration:",t.json.stringify(n)),c.version=e.VERSION,c.require=function(){var t=o(arguments),e=t[0],i=t[1];i&&r(n,e,function(t){a(n,t,function(t){i.apply(this,t)},c)})},c.build=function(){var e=o(arguments),a=e[0],u=e[1];u&&r(n,a,function(e){t.mapAsync(e,function(t,e){i(n,t,e,c)},function(t){u.apply(this,t)})})},c.getCurrentScript=e.getCurrentScript,c}var c=s({cache:!0,debug:!1,baseURI:e.getBaseURI()});if(n.browser){var f=e.getCurrentScript();if(f){f.parentNode.removeChild(f);var p=f.getAttribute("data-main"),l=f.innerText||"";p?c.require(p,Function("main",l)):l&&Function(l)()}}return c}(r,o,a,h,g,d);"object"==typeof this.process&&"string"==typeof this.process.version&&"object"==typeof module&&"object"==typeof module.exports?module.exports=v:"function"==typeof t.krang&&t.define(v)||(t.krang=v)})(function(){return this}.call(null));